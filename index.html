<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="HiP-AD.">
  <meta name="keywords" content="HiP-AD">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>HiP-AD: Hierarchical and Multi-Granularity Planning with Deformable Attention for Autonomous Driving in a Single Decoder</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <!-- <link rel="icon" href="./static/images/favicon.svg"> -->

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>



<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">HiP-AD: Hierarchical and Multi-Granularity Planning with Deformable Attention for Autonomous Driving in a Single Decoder</h1>
          <div class="is-size-4 publication-authors">
            <span class="author-block">
              Yingqi Tang<sup>*</sup>,</span>
            <span class="author-block">
              Zhuoran Xu<sup>*</sup>,</span>
            <span class="author-block">
              Zhaotie Meng<sup></sup>,</span>
            <span class="author-block">
              Erkang Cheng<sup>✉</sup></span>
          </div>

          <div class="is-size-4 publication-authors">
            <span class="author-block">Nullmax</span>
          </div>
    
          <p></p>
          <span class="author-block"><sup>*</sup>Equal Contributions.</span>
          <span class="author-block"><sup>✉</sup>Corresponding Authors.</span>
          </div>
        </div>


        <div class="column has-text-centered">
          <div class="publication-links">
            <span class="link-block">
              <a href="https://arxiv.org/abs/2503.08612"  # TODO
                 class="external-link button is-normal is-rounded is-dark">
                <span class="icon">
                    <i class="fas fa-file-pdf"></i>
                </span>
                <span>Paper</span>
              </a>
            </span>
            
            <span class="link-block">
              <a href="https://github.com/nullmax-vision/HiP-AD"
                 class="external-link button is-normal is-rounded is-dark">
                <span class="icon">
                    <i class="fab fa-github"></i>
                </span>
                <span>Code</span>
                </a>
            </span>
          </div>
      </div>
    </div>
  </div>
</section>



<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">

        <h2 class="title is-3" style="margin-top: -65px;">Abstract</h2>
        <div class="content has-text-justified">
          <p style="font-size: 12px;">
            Although end-to-end autonomous driving (E2E-AD) technologies have made significant progress in recent years, there remains an unsatisfactory performance on closed-loop evaluation. 
            The potential of leveraging planning in query design and interaction has not yet been fully explored.
            In this paper, we introduce a multi-granularity planning query representation that integrates heterogeneous waypoints, including spatial, temporal, and driving-style waypoints across various sampling patterns. It provides additional supervision for trajectory prediction, enhancing precise closed-loop control for the ego vehicle.
            Additionally, we explicitly utilize the geometric properties of planning trajectories to effectively retrieve relevant image features based on physical locations using deformable attention. 
            By combining these strategies, we propose a novel end-to-end autonomous driving framework, termed HiP-AD, which simultaneously performs perception, prediction, and planning within a unified decoder.
            HiP-AD enables comprehensive interaction by allowing planning queries to iteratively interact with perception queries in the BEV space while dynamically extracting image features from perspective views.
            Experiments demonstrate that HiP-AD outperforms all existing end-to-end autonomous driving methods on the closed-loop benchmark Bench2Drive and achieves competitive performance on the real-world dataset nuScenes. 
          </p>
        </div>

        <h2 class="title is-3" style="margin-top: 20px;">Framework</h2>
        <img src="./static/images/arch.jpg" class="interpolation-image" alt="Interpolation end reference image."/>

        <h2 class="title is-3" style="margin-top: 15px;">Scores</h2>
        <img src="./static/images/score.png" class="interpolation-image" style="width: 100%; height: auto;" alt="Interpolation end reference image."/>

        <h2 class="title is-3" style="margin-top: 40px;">Visualization</h2>
        <video id="matting-video-1" autoplay controls muted loop playsinline height="100%">
          <source src="./static/videos/hipad_closed_loop.mp4" type="video/mp4">
        </video>

      </div>
    </div>
  </div>
</section>


<!-- <section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{simpb,
  title     = {SimPB: A Single Model for 2D and 3D Object Detection from Multiple Cameras},
  author    = {Yingqi Tang and Zhaotie Meng and Guoliang Chen and Erkang Cheng},
  journal   = {ECCV},
  year      = {2024},
  }</code></pre>
  </div>
</section> -->


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link" href="https://github.com/nullmax-vision/SimPB" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            This static website is borrowed from <a href="https://github.com/nerfies/nerfies.github.io">nerfies</a>, thanks them provide an excellent template. 
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>


</body>
</html>
